---
sidebar_position: 4
---

import ClickableImage from '@site/src/components/ClickableImage';

# エントランスルームのカスタム

サンプルPrefab（`ERSEntranceRoom_Sample*`）を基に独自のエントランスルームを構築する際のポイントをまとめています。見た目や演出を自分のワールドに合わせて調整しつつ、Entrance Room System（ERS）の動作を維持するために以下の手順を参考にしてください。

## 1. Prefabを複製して編集する

- `Assets/mikinel/EntranceRoomSystem/Prefabs` から任意のサンプルPrefabを複製し、編集用の名前を付けます。
- 公式Prefabを直接編集するとアップデート時に上書きされる可能性があるため、必ず複製したものを使います。

## 2. 見た目の調整

- メッシュやマテリアル、照明などを自由に変更して外観を整えます。
- UI テキスト（注意書きや同意ボタン）を自分のイベント内容に変更してください。
- `Sample4 prefab` のようにライトベイク前提の部屋を使用する場合は、組み込みのライト設定を参考にライトベイクを実行します。

## 3. 必須オブジェクトを残す

エントランスルームPrefab内には ERS が参照する必須オブジェクトがあります。以下は削除や名称変更をしないでください。

- `ERSInteractAgreementAccessController`（同意ボタンやトリガーを管理）
- `ERSAgreementDisplay`（注意書き UI）
- `ERSPlayerPresenceBlocker` などのトラッキング用オブジェクト

必要に応じて UI を別レイアウトに差し替える際は、対応するコンポーネントを保持したまま配置を調整してください。

## 4. デバッグ・確認

1. カスタムした Prefab をシーンに配置し、`ERSFirstSpawnRoom` から視認できる位置に設置します。
2. `Play` モードで入室テストを行い、以下を確認します。
   - 入室時にエントランスルームへ転送される。
   - 注意書きの表示、同意ボタンやギミックが正しく動作する。
   - 同意後に `ERSSpawnPointData_MainArea` へ転送される。

## 5. よくある調整ポイント

- **音量・BGM**: 独自の効果音やBGMを追加する場合、エントランスルーム専用の AudioSource を用意し、メインエリアへの音漏れがないか確認します。
- **演出タイミング**: 粒子やアニメーションを追加した際は、同意ボタン操作と干渉しないようアニメーションのトリガータイミングを調整します。
- **パフォーマンス**: 一度に複数のプレイヤーが訪れるため、シェーダーやパーティクル数を抑えて処理負荷を下げることを推奨します。

---

カスタム後は、`スポーン位置等の調整` ガイドに沿って `ERSFirstSpawnRoom` や `ERSSpawnPointData_MainArea` の位置も確認し、入室フロー全体が期待どおりに動作することをテストしてください。
